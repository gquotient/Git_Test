<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width">

  <title>Test</title>

  <script type="text/javascript" data-main="../public/config.js" src="../public/components/require/require.js"></script>

  <link rel="stylesheet" href="components/mocha/mocha.css" media="screen">
</head>
<body>
  <div id="mocha"></div>
  <script>
    //Additional Require configuration
    require.config({
      paths: {
        mocha: '../test/components/mocha/mocha',
        chai: '../test/components/chai/chai'
      },
      shim: {
        mocha: {
          exports: 'mocha'
        }
      }
    });
  </script>
  <script>
    require([
      'chai',
      'mocha'
    ], function(chai, mocha){
      //Mocha setup
      mocha
        .setup('bdd')//Set the type of test format
        .globals(['hasCert', true])//Allow globals (like $ and every other library ever)
      ;

      //Append assert globally
      window.assert = chai.assert;

      //Encapsulate dual environment (browser/PhantomJS) test run method
      function runTest(){
        console.log('run test');
        if (window.mochaPhantomJS) {
          mochaPhantomJS.run();
        } else {
          mocha.run();
        }
      }

      //Require the app config for nice module names
      require(['../public/config'], function(){
        //Require ALL tests
        require([
          '../test/modules/user',
          '../test/modules/asyncExample'
        ], function(){
          //Fire run ONCE
          runTest();
        });
      });
    });
  </script>
</body>
</html>
